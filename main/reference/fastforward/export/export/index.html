
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="FastForward: Neural Network Quantization">
      
      
      
        <link rel="canonical" href="https://github.com/Qualcomm-AI-research/fastforward/export/export/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../graph_operations/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>export - FastForward</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#fastforward.export.export.GraphWrapper" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="FastForward" class="md-header__button md-logo" aria-label="FastForward" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FastForward
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              export
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Qualcomm-AI-research/fastforward" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Github
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../.." class="md-tabs__link">
          
  
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../examples/" class="md-tabs__link">
        
  
  
    
  
  Tutorials

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  API reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="FastForward" class="md-nav__button md-logo" aria-label="FastForward" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    FastForward
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Qualcomm-AI-research/fastforward" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Github
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    fastforward
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            fastforward
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../autoquant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    autoquant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../common/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    common
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dispatcher/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dispatcher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exceptions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    export
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_5" id="__nav_3_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_5">
            <span class="md-nav__icon md-icon"></span>
            export
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    export
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    export
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fastforward.export.export.GraphWrapper" class="md-nav__link">
    <span class="md-ellipsis">
      GraphWrapper
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GraphWrapper">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.GraphWrapper.graph_exported_program" class="md-nav__link">
    <span class="md-ellipsis">
      graph_exported_program
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.GraphWrapper.visit" class="md-nav__link">
    <span class="md-ellipsis">
      visit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fastforward.export.export.LogQuantizationParameter" class="md-nav__link">
    <span class="md-ellipsis">
      LogQuantizationParameter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LogQuantizationParameter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.LogQuantizationParameter.conclude" class="md-nav__link">
    <span class="md-ellipsis">
      conclude
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.LogQuantizationParameter.enter" class="md-nav__link">
    <span class="md-ellipsis">
      enter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.LogQuantizationParameter.visit" class="md-nav__link">
    <span class="md-ellipsis">
      visit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fastforward.export.export.NodeVisitor" class="md-nav__link">
    <span class="md-ellipsis">
      NodeVisitor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NodeVisitor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.NodeVisitor.conclude" class="md-nav__link">
    <span class="md-ellipsis">
      conclude
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.NodeVisitor.enter" class="md-nav__link">
    <span class="md-ellipsis">
      enter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.NodeVisitor.visit" class="md-nav__link">
    <span class="md-ellipsis">
      visit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fastforward.export.export.RemoveFunction" class="md-nav__link">
    <span class="md-ellipsis">
      RemoveFunction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RemoveFunction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.RemoveFunction.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.RemoveFunction.conclude" class="md-nav__link">
    <span class="md-ellipsis">
      conclude
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.RemoveFunction.enter" class="md-nav__link">
    <span class="md-ellipsis">
      enter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.RemoveFunction.visit" class="md-nav__link">
    <span class="md-ellipsis">
      visit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fastforward.export.export.RequestNode" class="md-nav__link">
    <span class="md-ellipsis">
      RequestNode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RequestNode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.RequestNode.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.RequestNode.conclude" class="md-nav__link">
    <span class="md-ellipsis">
      conclude
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.RequestNode.enter" class="md-nav__link">
    <span class="md-ellipsis">
      enter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fastforward.export.export.RequestNode.visit" class="md-nav__link">
    <span class="md-ellipsis">
      visit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fastforward.export.export.export" class="md-nav__link">
    <span class="md-ellipsis">
      export
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fastforward.export.export.process_dynamo_program" class="md-nav__link">
    <span class="md-ellipsis">
      process_dynamo_program
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph_operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    graph_operations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../module_export/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    module_export
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    flags
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../forward_override/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    forward_override
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../logging_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    logging_utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../mpath/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    mpath
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_9" id="__nav_3_1_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_9">
            <span class="md-nav__icon md-icon"></span>
            mpath
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mpath/fragments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fragments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mpath/selector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    selector
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../nn/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    nn
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_10" id="__nav_3_1_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_10">
            <span class="md-nav__icon md-icon"></span>
            nn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nn/activations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    activations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nn/container/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    container
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nn/conv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    conv
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nn/dynamic_linear_quantizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dynamic_linear_quantizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nn/embedding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    embedding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nn/functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    functional
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nn/linear/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linear
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nn/linear_quantizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linear_quantizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nn/normalization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    normalization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nn/quantized_module/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    quantized_module
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../nn/quantizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    quantizer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overrides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    overrides
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_12" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../quantization/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    quantization
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_12" id="__nav_3_1_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_12">
            <span class="md-nav__icon md-icon"></span>
            quantization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_12_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../quantization/affine/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    affine
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_12_1" id="__nav_3_1_12_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_12_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_12_1">
            <span class="md-nav__icon md-icon"></span>
            affine
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/affine/dynamic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dynamic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/affine/function/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    function
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/affine/range/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    range
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/affine/static/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    static
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/function/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    function
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/granularity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    granularity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/local_error/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    local_error
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/output_mse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    output_mse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/quant_init/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    quant_init
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/random/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    random
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/ste/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ste
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/strict_quantization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    strict_quantization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/tiled_tensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    tiled_tensor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantized_tensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    quantized_tensor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_14" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../range_setting/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    range_setting
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_14" id="__nav_3_1_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_14">
            <span class="md-nav__icon md-icon"></span>
            range_setting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../range_setting/common/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    common
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../range_setting/min_error/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    min_error
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../range_setting/minmax/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    minmax
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_15" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../testing/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    testing
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_15" id="__nav_3_1_15_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_15">
            <span class="md-nav__icon md-icon"></span>
            testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../testing/cfg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cfg
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../testing/initialization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    initialization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../testing/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../testing/string/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    string
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../type_common/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    type_common
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>export</h1>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">

        <div class="admonition experimental">
<p class="admonition-title">Experimental</p>
<p>Export is an experimental feature and is currently under active development.
Please expect API changes. We encourage you to file bug reports if you run into any problems.</p>
</div>
<p>Functionality to export a quantized module for running inference on device.</p>


<details class="supported-backends" open>
  <summary>Supported backends</summary>
  <ul>
<li>QNN</li>
</ul>
</details>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="fastforward.export.export.GraphWrapper" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">fastforward</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">GraphWrapper</span><span class="p">(</span><span class="n">graph_exported_program</span><span class="p">)</span></code>

<a href="#fastforward.export.export.GraphWrapper" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">


        <p>Wrapper class around a ExportedProgram.</p>
<p>It that facilitates graph operations, such as logging/manipulation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>graph_exported_program</code>
            </td>
            <td>
                  <code><span title="torch.export.exported_program.ExportedProgram">ExportedProgram</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The resulting exported program object resulting from
a <code>torch.export.export</code> function call.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>fastforward/export/export.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">357</span>
<span class="normal">358</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph_exported_program</span><span class="p">:</span> <span class="n">ExportedProgram</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">graph_exported_program</span> <span class="o">=</span> <span class="n">graph_exported_program</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="fastforward.export.export.GraphWrapper.graph_exported_program" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">graph_exported_program</span> <span class="o">=</span> <span class="n">graph_exported_program</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#fastforward.export.export.GraphWrapper.graph_exported_program" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="fastforward.export.export.GraphWrapper.visit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">visit</span><span class="p">(</span><span class="n">visitor</span><span class="p">)</span></code>

<a href="#fastforward.export.export.GraphWrapper.visit" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Method to iterate through the nodes of the instance's graph.</p>
<p>Given a NodeVisitor object check if a given node matches the visitor's
criteria and if so perform the visitor-defined operations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>visitor</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;code&gt;fastforward.export.export.NodeVisitor&lt;/code&gt;" href="#fastforward.export.export.NodeVisitor">NodeVisitor</a>[<span title="fastforward.export.export._T">_T</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>NodeVisitor</code> object that defines some operation that needs to be
performed on the graph's nodes, or a subset of its nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="fastforward.export.export._T">_T</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value returned by <code>visitor.conclude()</code></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visitor</span><span class="p">:</span> <span class="n">NodeVisitor</span><span class="p">[</span><span class="n">_T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Method to iterate through the nodes of the instance&#39;s graph.</span>

<span class="sd">    Given a NodeVisitor object check if a given node matches the visitor&#39;s</span>
<span class="sd">    criteria and if so perform the visitor-defined operations.</span>

<span class="sd">    Args:</span>
<span class="sd">        visitor: A `NodeVisitor` object that defines some operation that needs to be</span>
<span class="sd">            performed on the graph&#39;s nodes, or a subset of its nodes.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The value returned by `visitor.conclude()`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Node</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_exported_program</span><span class="o">.</span><span class="n">graph_module</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">nodes</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">visitor</span><span class="o">.</span><span class="n">enter</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
            <span class="n">visitor</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_exported_program</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">visitor</span><span class="o">.</span><span class="n">conclude</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="fastforward.export.export.LogQuantizationParameter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">fastforward</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">LogQuantizationParameter</span><span class="p">(</span><span class="n">op_type</span><span class="p">,</span> <span class="n">target_name</span><span class="p">)</span></code>

<a href="#fastforward.export.export.LogQuantizationParameter" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;code&gt;fastforward.export.export.NodeVisitor&lt;/code&gt;" href="#fastforward.export.export.NodeVisitor">NodeVisitor</a>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code></p>


        <p>Log Quantization parameters.</p>
<p>NodeVisitor subclass responsible for logging the quantization parameter of
a subset of nodes.</p>
<p>In the case of quantization, the FastForward operations (<code>quantize_by_tile</code> and
<code>dequantize_by_tile</code>) are represented in the graph. The torch.fx nodes for these
operations contain the parameters that need to be logged, where the first input
to the node is the parameter/activation to be quantized, and the node arguments
provide the quantization parameters.</p>
<p>The result of this subclass are stored in a dictionary where the keys are the names of the
parameter/activation nodes, and the values are their corresponding quantization parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>op_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of operation that is of interest. The types of operations
correspond to the <code>op</code> property of the torch.fx nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the target graph operation. The underlying operation
that a torch.fx node invokes when performing a forward pass. For example,
for the fastforward operation <code>quantize_by_tile</code> the target name will
be <code>fastforward::quantize_by_tile</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>fastforward/export/export.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_op_type</span> <span class="o">=</span> <span class="n">op_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_target_name</span> <span class="o">=</span> <span class="n">target_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_logs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_module_named_parameters</span><span class="p">:</span> <span class="nb">frozenset</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_module_named_buffers</span><span class="p">:</span> <span class="nb">frozenset</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_module</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="fastforward.export.export.LogQuantizationParameter.conclude" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">conclude</span><span class="p">()</span></code>

<a href="#fastforward.export.export.LogQuantizationParameter.conclude" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@override</span>
<span class="k">def</span><span class="w"> </span><span class="nf">conclude</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_logs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="fastforward.export.export.LogQuantizationParameter.enter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">enter</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></code>

<a href="#fastforward.export.export.LogQuantizationParameter.enter" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@override</span>
<span class="k">def</span><span class="w"> </span><span class="nf">enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="n">node_name</span> <span class="o">=</span> <span class="n">_node_name_as_string</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">op</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_op_type</span> <span class="ow">and</span> <span class="n">node_name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target_name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="fastforward.export.export.LogQuantizationParameter.visit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">visit</span><span class="p">(</span><span class="n">graph_exported_program</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></code>

<a href="#fastforward.export.export.LogQuantizationParameter.visit" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@override</span>
<span class="k">def</span><span class="w"> </span><span class="nf">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph_exported_program</span><span class="p">:</span> <span class="n">ExportedProgram</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">input_specs</span> <span class="o">=</span> <span class="n">graph_exported_program</span><span class="o">.</span><span class="n">graph_signature</span><span class="o">.</span><span class="n">input_specs</span>
    <span class="n">arg_to_parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg_to_parameter</span><span class="p">(</span><span class="n">input_specs</span><span class="p">)</span>
    <span class="n">function_name</span> <span class="o">=</span> <span class="n">_node_name_as_string</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="n">function_parameter_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_function_parameter_names</span><span class="p">(</span><span class="n">function_name</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_log_quantization_parameters</span><span class="p">(</span>
        <span class="n">node</span><span class="p">,</span> <span class="n">graph_exported_program</span><span class="p">,</span> <span class="n">arg_to_parameter</span><span class="p">,</span> <span class="n">function_parameter_names</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="fastforward.export.export.NodeVisitor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>fastforward.export.export.NodeVisitor</code>


<a href="#fastforward.export.export.NodeVisitor" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code>, <code><span title="typing.Generic">Generic</span>[<span title="fastforward.export.export._T">_T</span>]</code></p>


        <p>Base class for interacting with torch fx node object in a dynamo graph.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="fastforward.export.export.NodeVisitor.conclude" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">conclude</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#fastforward.export.export.NodeVisitor.conclude" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Conclude processing.</p>
<p>Method for performing any additional operations after the main processing from the
<code>visit</code> method has concluded. This can include some cleanup actions or returning some
values.</p>
<p>The value returned by <code>conclude</code> is returned by <code>GraphWrapper.visit()</code></p>


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">conclude</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Conclude processing.</span>

<span class="sd">    Method for performing any additional operations after the main processing from the</span>
<span class="sd">    `visit` method has concluded. This can include some cleanup actions or returning some</span>
<span class="sd">    values.</span>

<span class="sd">    The value returned by `conclude` is returned by `GraphWrapper.visit()`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="fastforward.export.export.NodeVisitor.enter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">enter</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#fastforward.export.export.NodeVisitor.enter" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Method for checking whether a given node will be accessed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node</code>
            </td>
            <td>
                  <code><span title="torch.fx.node.Node">Node</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A torch fx node object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Method for checking whether a given node will be accessed.</span>

<span class="sd">    Args:</span>
<span class="sd">        node: A torch fx node object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="fastforward.export.export.NodeVisitor.visit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">visit</span><span class="p">(</span><span class="n">graph_exported_program</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#fastforward.export.export.NodeVisitor.visit" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Method for performing an operation with reference to the given node.</p>
<p>In certain cases the <code>ExportedProgram</code> object is required in order to
perform more in-depth graph manipulation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>graph_exported_program</code>
            </td>
            <td>
                  <code><span title="torch.export.exported_program.ExportedProgram">ExportedProgram</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An <code>ExportedProgram</code> object resulting from <code>torch.export.export</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>node</code>
            </td>
            <td>
                  <code><span title="torch.fx.node.Node">Node</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A torch fx node object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph_exported_program</span><span class="p">:</span> <span class="n">ExportedProgram</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Method for performing an operation with reference to the given node.</span>

<span class="sd">    In certain cases the `ExportedProgram` object is required in order to</span>
<span class="sd">    perform more in-depth graph manipulation.</span>

<span class="sd">    Args:</span>
<span class="sd">        graph_exported_program: An `ExportedProgram` object resulting from `torch.export.export`.</span>
<span class="sd">        node: A torch fx node object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="fastforward.export.export.RemoveFunction" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">fastforward</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">RemoveFunction</span><span class="p">(</span><span class="n">op_type</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">input_replace_idx</span><span class="p">)</span></code>

<a href="#fastforward.export.export.RemoveFunction" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;code&gt;fastforward.export.export.NodeVisitor&lt;/code&gt;" href="#fastforward.export.export.NodeVisitor">NodeVisitor</a>[None]</code></p>


        <p>NodeVisitor subclass responsible for removing nodes from a graph.</p>
<p>This is done by reconfiguring the input/outputs from a given node. For
example, consider a three node graph containing nodes <code>x</code>, <code>y</code>, <code>z</code> with
the following simple structure:</p>
<pre><code>    x -&gt; y -&gt; z
</code></pre>
<p>If we want to remove the <code>y</code> node, we can access with the criteria defined to the <code>enter</code> method,
find its input node (<code>x</code>) and its output node (<code>z</code>) and replace the input to <code>z</code> to be <code>x</code>. So,
the resulting graph looks like this:</p>
<pre><code>       y

    x -&gt; z
</code></pre>
<p>Note that at this stage the <code>y</code> node is not removed yet. This can be done by invoking the
torch graph API. ATTENTION: a node that is being used by other nodes cannot be removed, dynamo
will raise an error if that is attempted. For this reason, the reconfiguration of inputs/outputs
needs to be done first.</p>
<p>The class will work with nodes that have multiple output nodes, where the node's parent will
be connected to each different output. ATTENTION: this is not the case with the node inputs, where
we assume that only one input is of importance.</p>
<p>Finally, note that this reconfiguration needs to happen for a intermediate node (the node needs to have at least
one input, and at least one output) otherwise the reconnection will raise an error.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>op_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of operation that is of interest. The types of operations
correspond to the <code>op</code> property of the torch.fx nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the target graph operation. The underlying operation
that a torch.fx node invokes when performing a forward pass. For example,
for the fastforward operation <code>quantize_by_tile</code> the target name will
be <code>fastforward::quantize_by_tile</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_replace_idx</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the current nodes input that will be redirected
to the output node's input.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>fastforward/export/export.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">input_replace_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_op_type</span> <span class="o">=</span> <span class="n">op_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_target_name</span> <span class="o">=</span> <span class="n">target_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_input_replace_idx</span> <span class="o">=</span> <span class="n">input_replace_idx</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="fastforward.export.export.RemoveFunction.__repr__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#fastforward.export.export.RemoveFunction.__repr__" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@override</span>
<span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_op_type</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_target_name</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="fastforward.export.export.RemoveFunction.conclude" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">conclude</span><span class="p">()</span></code>

<a href="#fastforward.export.export.RemoveFunction.conclude" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@override</span>
<span class="k">def</span><span class="w"> </span><span class="nf">conclude</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="fastforward.export.export.RemoveFunction.enter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">enter</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></code>

<a href="#fastforward.export.export.RemoveFunction.enter" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@override</span>
<span class="k">def</span><span class="w"> </span><span class="nf">enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="n">node_name</span> <span class="o">=</span> <span class="n">_node_name_as_string</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">op</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_op_type</span> <span class="ow">and</span> <span class="n">node_name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target_name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="fastforward.export.export.RemoveFunction.visit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">visit</span><span class="p">(</span><span class="n">graph_exported_program</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></code>

<a href="#fastforward.export.export.RemoveFunction.visit" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@override</span>
<span class="k">def</span><span class="w"> </span><span class="nf">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph_exported_program</span><span class="p">:</span> <span class="n">ExportedProgram</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_remove_node</span><span class="p">(</span><span class="n">graph_exported_program</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_replace_idx</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="fastforward.export.export.RequestNode" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">fastforward</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">RequestNode</span><span class="p">(</span><span class="n">op_type</span><span class="p">,</span> <span class="n">target_name</span><span class="p">)</span></code>

<a href="#fastforward.export.export.RequestNode" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;code&gt;fastforward.export.export.NodeVisitor&lt;/code&gt;" href="#fastforward.export.export.NodeVisitor">NodeVisitor</a>[<span title="list">list</span>[<span title="torch.fx.node.Node">Node</span>]]</code></p>


        <p>NodeVisitor subclass responsible for grabbing nodes from a graph.</p>
<p>Simple query class which can return all the nodes that match certain
criteria.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>op_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of operation that is of interest. The types of operations
correspond to the <code>op</code> property of the torch.fx nodes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the target graph operation. The underlying operation
that a torch.fx node invokes when performing a forward pass. For example,
for the fastforward operation <code>quantize_by_tile</code> the target name will
be <code>fastforward::quantize_by_tile</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>fastforward/export/export.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_op_type</span> <span class="o">=</span> <span class="n">op_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_target_name</span> <span class="o">=</span> <span class="n">target_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Node</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="fastforward.export.export.RequestNode.__repr__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#fastforward.export.export.RequestNode.__repr__" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@override</span>
<span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_op_type</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_target_name</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="fastforward.export.export.RequestNode.conclude" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">conclude</span><span class="p">()</span></code>

<a href="#fastforward.export.export.RequestNode.conclude" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@override</span>
<span class="k">def</span><span class="w"> </span><span class="nf">conclude</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Node</span><span class="p">]:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="fastforward.export.export.RequestNode.enter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">enter</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></code>

<a href="#fastforward.export.export.RequestNode.enter" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@override</span>
<span class="k">def</span><span class="w"> </span><span class="nf">enter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="n">node_name</span> <span class="o">=</span> <span class="n">_node_name_as_string</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">op</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_op_type</span> <span class="ow">and</span> <span class="n">node_name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_target_name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="fastforward.export.export.RequestNode.visit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">visit</span><span class="p">(</span><span class="n">graph_exported_program</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span></code>

<a href="#fastforward.export.export.RequestNode.visit" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@override</span>
<span class="k">def</span><span class="w"> </span><span class="nf">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph_exported_program</span><span class="p">:</span> <span class="n">ExportedProgram</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="fastforward.export.export.export" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">fastforward</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">output_directory</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">graph_preprocessors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">input_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enable_encodings_propagation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#fastforward.export.export.export" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>The main export function for retrieving artifacts that can be passed to QNN.</p>
<p>This function takes an user-defined torch model (which can contain fastforward layers
and quantizers). It then performs three processing steps:</p>
<p>1) Extract a dynamo graph (in the form of an exported program object) from the torch model.
    During this process quantization is changed to simulated quantization, leading to the
    graph having <code>quantize_by_tile</code> operations followed by <code>dequantize_by_tile</code> operations.
2) Performs operations on the dynamo graph. Here, the following operations are required.
    a) log the parameters of any <code>quantize_by_tile</code> functions. These are required for creating
        the QNN encodings file.
    b) remove any quantization operations as these are not required by QNN. This is done in
        sequence, first removing <code>dequantize_by_tile</code>, connecting its output to its parent
        <code>quantize_by_tile</code> node. Then <code>quantize_by_tile</code> operations are removed and their
        output is connected their respective parent node. <strong>ATTENTION</strong>: in the case the user
        defines a graph preprocessor targeting a <code>quantize_by_tile</code> or <code>dequantize_by_tile</code>
        operation, they need to be aware that these will ultimately be removed from the graph.
        In addition, it is possible that some <code>dequantize_by_tile</code> nodes are output nodes of
        the graph. Our node removal process accommodates for that, but when designing bespoke
        graph preprocessors targeting these nodes, this behaviour needs to be taken into account.
3) The processed dynamo graph is exported to ONNX, using the <code>torch_onnx</code> library, and the
    names of inputs/activations/parameters are mapped between dynamo and ONNX. Based on this
    information the encodings file required for QNN is generated.
4) In the case that the <code>input_names</code> and/or <code>output_names</code> arguments are used then the inputs/
    outputs of the ONNX model are renamed accordingly. <strong>ATTENTION</strong>: the renaming operation takes
    place in the ONNX level, <strong>NOT</strong> the dynamo level. This means that if the user defines
    any graph preprocessor operations that target the dynamo input/output nodes, there will
    be a name mismatch between the dynamo input/output names and the ONNX input/output names.
5) In the case where the <code>enable_encodings_propagation</code> argument is set to `True encodings will be
    automatically inferred to any operations where that is possible.</p>
<p>Finally the function will store the model in the user-defined <code>output_directory</code>, using the
user-defined <code>model_name</code>.</p>
<p>The function raises an <code>ExportError</code> exception if PyTorch version &lt; 2.5 is used.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="torch.nn.Module">Module</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A torch module, can contain FF modules.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A torch <code>Tensor</code> object that compatible with the model's input shape.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_directory</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory where the artifacts (ONNX model, encodings file) will be
stored.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>graph_preprocessors</code>
            </td>
            <td>
                  <code>None | <span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;code&gt;fastforward.export.export.NodeVisitor&lt;/code&gt;" href="#fastforward.export.export.NodeVisitor">NodeVisitor</a>[<span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optionally pass a list of operations that can take place before the
standard export graph operations required by QNN (parameter logging, removal of
quantization/dequantization operations).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model_kwargs</code>
            </td>
            <td>
                  <code>None | <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>kwargs passed to the model during export.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_names</code>
            </td>
            <td>
                  <code>None | <span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Replace the default ONNX artifact input names with user defined ones.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_names</code>
            </td>
            <td>
                  <code>None | <span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Replace the default ONNX artifact output names with user defined ones.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enable_encodings_propagation</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Option to propagate the quantization encodings through as many
view-type operations in the graph as possible.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print verbose messages. If <code>None</code>, some messages will be printed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@ff</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">ff</span><span class="o">.</span><span class="n">strict_quantization</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">export</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="n">output_directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span>
    <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">graph_preprocessors</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">NodeVisitor</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">model_kwargs</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">input_names</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output_names</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">enable_encodings_propagation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The main export function for retrieving artifacts that can be passed to QNN.</span>

<span class="sd">    This function takes an user-defined torch model (which can contain fastforward layers</span>
<span class="sd">    and quantizers). It then performs three processing steps:</span>

<span class="sd">    1) Extract a dynamo graph (in the form of an exported program object) from the torch model.</span>
<span class="sd">        During this process quantization is changed to simulated quantization, leading to the</span>
<span class="sd">        graph having `quantize_by_tile` operations followed by `dequantize_by_tile` operations.</span>
<span class="sd">    2) Performs operations on the dynamo graph. Here, the following operations are required.</span>
<span class="sd">        a) log the parameters of any `quantize_by_tile` functions. These are required for creating</span>
<span class="sd">            the QNN encodings file.</span>
<span class="sd">        b) remove any quantization operations as these are not required by QNN. This is done in</span>
<span class="sd">            sequence, first removing `dequantize_by_tile`, connecting its output to its parent</span>
<span class="sd">            `quantize_by_tile` node. Then `quantize_by_tile` operations are removed and their</span>
<span class="sd">            output is connected their respective parent node. __ATTENTION__: in the case the user</span>
<span class="sd">            defines a graph preprocessor targeting a `quantize_by_tile` or `dequantize_by_tile`</span>
<span class="sd">            operation, they need to be aware that these will ultimately be removed from the graph.</span>
<span class="sd">            In addition, it is possible that some `dequantize_by_tile` nodes are output nodes of</span>
<span class="sd">            the graph. Our node removal process accommodates for that, but when designing bespoke</span>
<span class="sd">            graph preprocessors targeting these nodes, this behaviour needs to be taken into account.</span>
<span class="sd">    3) The processed dynamo graph is exported to ONNX, using the `torch_onnx` library, and the</span>
<span class="sd">        names of inputs/activations/parameters are mapped between dynamo and ONNX. Based on this</span>
<span class="sd">        information the encodings file required for QNN is generated.</span>
<span class="sd">    4) In the case that the `input_names` and/or `output_names` arguments are used then the inputs/</span>
<span class="sd">        outputs of the ONNX model are renamed accordingly. __ATTENTION__: the renaming operation takes</span>
<span class="sd">        place in the ONNX level, __NOT__ the dynamo level. This means that if the user defines</span>
<span class="sd">        any graph preprocessor operations that target the dynamo input/output nodes, there will</span>
<span class="sd">        be a name mismatch between the dynamo input/output names and the ONNX input/output names.</span>
<span class="sd">    5) In the case where the `enable_encodings_propagation` argument is set to `True encodings will be</span>
<span class="sd">        automatically inferred to any operations where that is possible.</span>

<span class="sd">    Finally the function will store the model in the user-defined `output_directory`, using the</span>
<span class="sd">    user-defined `model_name`.</span>

<span class="sd">    The function raises an `ExportError` exception if PyTorch version &lt; 2.5 is used.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: A torch module, can contain FF modules.</span>
<span class="sd">        data: A torch `Tensor` object that compatible with the model&#39;s input shape.</span>
<span class="sd">        output_directory: The directory where the artifacts (ONNX model, encodings file) will be</span>
<span class="sd">            stored.</span>
<span class="sd">        model_name: The name of the model.</span>
<span class="sd">        graph_preprocessors: Optionally pass a list of operations that can take place before the</span>
<span class="sd">            standard export graph operations required by QNN (parameter logging, removal of</span>
<span class="sd">            quantization/dequantization operations).</span>
<span class="sd">        model_kwargs: kwargs passed to the model during export.</span>
<span class="sd">        input_names: Replace the default ONNX artifact input names with user defined ones.</span>
<span class="sd">        output_names: Replace the default ONNX artifact output names with user defined ones.</span>
<span class="sd">        enable_encodings_propagation: Option to propagate the quantization encodings through as many</span>
<span class="sd">            view-type operations in the graph as possible.</span>
<span class="sd">        verbose: Whether to print verbose messages. If `None`, some messages will be printed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;</span> <span class="s2">&quot;2.5&quot;</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Export functionality is only supported for PyTorch version 2.5 and above. &quot;</span>
            <span class="s2">&quot;Please upgrade your PyTorch installation to use this feature.&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">ExportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">output_directory</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">output_directory</span><span class="p">)</span>
    <span class="n">output_directory</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">onnx_location</span> <span class="o">=</span> <span class="n">output_directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">.onnx&quot;</span>
    <span class="n">encodings_location</span> <span class="o">=</span> <span class="n">output_directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">.encodings&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">graph_preprocessors</span><span class="p">:</span>
        <span class="n">graph_preprocessors</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">log_quantization_parameter_operation_location</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">graph_preprocessors</span><span class="p">)</span>

    <span class="n">default_graph_operators</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NodeVisitor</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">LogQuantizationParameter</span><span class="p">(</span><span class="s2">&quot;call_function&quot;</span><span class="p">,</span> <span class="s2">&quot;fastforward::quantize_by_tile&quot;</span><span class="p">),</span>
        <span class="n">RemoveFunction</span><span class="p">(</span><span class="s2">&quot;call_function&quot;</span><span class="p">,</span> <span class="s2">&quot;fastforward::dequantize_by_tile&quot;</span><span class="p">,</span> <span class="n">input_replace_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">RemoveFunction</span><span class="p">(</span><span class="s2">&quot;call_function&quot;</span><span class="p">,</span> <span class="s2">&quot;fastforward::quantize_by_tile&quot;</span><span class="p">,</span> <span class="n">input_replace_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">graph_operators</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">graph_preprocessors</span><span class="p">,</span> <span class="o">*</span><span class="n">default_graph_operators</span><span class="p">]</span>

    <span class="k">with</span> <span class="n">export_mode</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s2">&quot;onnxscript.*&quot;</span><span class="p">)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s2">&quot;torch._dynamo.*&quot;</span><span class="p">)</span>
        <span class="n">dynamo_exported_program</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">export</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="n">model_kwargs</span>
        <span class="p">)</span><span class="o">.</span><span class="n">run_decompositions</span><span class="p">()</span>

    <span class="n">dynamo_exported_program</span><span class="p">,</span> <span class="n">new_old_input_spec_mapping</span><span class="p">,</span> <span class="n">raw_logs</span> <span class="o">=</span> <span class="n">process_dynamo_program</span><span class="p">(</span>
        <span class="n">dynamo_exported_program</span><span class="p">,</span> <span class="n">graph_operators</span>
    <span class="p">)</span>
    <span class="c1"># We only care about the logs from the first operation (LogQuantizationParameter) in the</span>
    <span class="c1"># hardcoded graph operations (which will always take place when exporting for QNN).</span>
    <span class="c1"># Given that the users could have defined additional operations that happen before these,</span>
    <span class="c1"># we keep track of it location in the list.</span>
    <span class="n">quantization_logs</span> <span class="o">=</span> <span class="n">raw_logs</span><span class="p">[</span><span class="n">log_quantization_parameter_operation_location</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">enable_encodings_propagation</span><span class="p">:</span>
        <span class="n">propagated_encodings_dict</span> <span class="o">=</span> <span class="n">propagate_encodings</span><span class="p">(</span><span class="n">dynamo_exported_program</span><span class="p">,</span> <span class="n">quantization_logs</span><span class="p">)</span>
        <span class="n">quantization_logs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">propagated_encodings_dict</span><span class="p">)</span>

    <span class="n">torch_onnx_model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">onnx</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">dynamo_exported_program</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span><span class="o">.</span><span class="n">model</span>  <span class="c1"># type: ignore[call-arg, arg-type, union-attr, unused-ignore]</span>
    <span class="n">torch_onnx_inputs</span> <span class="o">=</span> <span class="n">torch_onnx_model</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">inputs</span>
    <span class="n">torch_onnx_outputs</span> <span class="o">=</span> <span class="n">torch_onnx_model</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">outputs</span>

    <span class="k">if</span> <span class="n">input_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">input_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">torch_onnx_inputs</span><span class="p">:</span>
            <span class="c1"># The input node should always have a name,</span>
            <span class="c1"># otherwise something is wrong with the graph.</span>
            <span class="k">assert</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">input_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">torch_onnx_outputs</span><span class="p">:</span>
            <span class="c1"># The output node should always have a name,</span>
            <span class="c1"># otherwise something is wrong with the graph.</span>
            <span class="k">assert</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">output_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">torch_onnx_inputs</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_names</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">torch_onnx_outputs</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_names</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The number of user-defined inputs/outputs (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">input_names</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">output_names</span><span class="p">)</span><span class="si">}</span><span class="s2">) &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;does not match the number of graph inputs/outputs &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">torch_onnx_inputs</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">torch_onnx_outputs</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">old_input</span><span class="p">,</span> <span class="n">new_input_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">torch_onnx_inputs</span><span class="p">,</span> <span class="n">input_names</span><span class="p">):</span>
        <span class="n">old_input_name</span> <span class="o">=</span> <span class="n">old_input</span><span class="o">.</span><span class="n">name</span>
        <span class="n">old_input</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">new_input_name</span>
        <span class="k">if</span> <span class="n">old_input_name</span> <span class="ow">in</span> <span class="n">new_old_input_spec_mapping</span><span class="p">:</span>
            <span class="n">new_old_input_spec_mapping</span><span class="p">[</span><span class="n">new_input_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_old_input_spec_mapping</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span>
                <span class="n">old_input_name</span>
            <span class="p">)</span>

    <span class="k">for</span> <span class="n">old_output</span><span class="p">,</span> <span class="n">new_output_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">torch_onnx_outputs</span><span class="p">,</span> <span class="n">output_names</span><span class="p">):</span>
        <span class="n">old_output_name</span> <span class="o">=</span> <span class="n">old_output</span><span class="o">.</span><span class="n">name</span>
        <span class="n">old_output</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">new_output_name</span>
        <span class="k">if</span> <span class="n">old_output_name</span> <span class="ow">in</span> <span class="n">quantization_logs</span><span class="p">:</span>
            <span class="n">quantization_logs</span><span class="p">[</span><span class="n">new_output_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">quantization_logs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">old_output_name</span><span class="p">)</span>

    <span class="n">proto</span> <span class="o">=</span> <span class="n">onnxscript</span><span class="o">.</span><span class="n">ir</span><span class="o">.</span><span class="n">to_proto</span><span class="p">(</span><span class="n">torch_onnx_model</span><span class="p">)</span>
    <span class="n">onnx</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">proto</span><span class="p">,</span> <span class="n">onnx_location</span><span class="p">)</span>

    <span class="n">used_inputs</span><span class="p">,</span> <span class="n">_unused_inputs</span> <span class="o">=</span> <span class="n">get_inputs</span><span class="p">(</span>
        <span class="n">torch_onnx_model</span><span class="p">,</span> <span class="n">quantization_logs</span><span class="p">,</span> <span class="n">new_old_input_spec_mapping</span>
    <span class="p">)</span>
    <span class="n">used_activations</span><span class="p">,</span> <span class="n">_unused_activations</span> <span class="o">=</span> <span class="n">get_activations</span><span class="p">(</span><span class="n">proto</span><span class="p">,</span> <span class="n">quantization_logs</span><span class="p">)</span>
    <span class="n">used_parameters</span><span class="p">,</span> <span class="n">_unused_parameters</span> <span class="o">=</span> <span class="n">get_parameters</span><span class="p">(</span><span class="n">torch_onnx_model</span><span class="p">,</span> <span class="n">quantization_logs</span><span class="p">)</span>

    <span class="n">encodings_dictionary</span> <span class="o">=</span> <span class="n">generate_qnn_encodings_dictionary</span><span class="p">(</span>
        <span class="n">used_inputs</span><span class="p">,</span> <span class="n">used_activations</span><span class="p">,</span> <span class="n">used_parameters</span><span class="p">,</span> <span class="n">quantization_logs</span>
    <span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">encodings_location</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">encodings_dictionary</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="n">onnx</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
        <span class="n">proto</span><span class="p">,</span>
        <span class="n">onnx_location</span><span class="p">,</span>
        <span class="n">save_as_external_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">all_tensors_to_one_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">location</span><span class="o">=</span><span class="s2">&quot;filename&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="fastforward.export.export.process_dynamo_program" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <code class="highlight language-python"><span class="n">fastforward</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">export</span><span class="o">.</span><span class="n">process_dynamo_program</span><span class="p">(</span><span class="n">dynamo_exported_program</span><span class="p">,</span> <span class="n">graph_operators</span><span class="p">)</span></code>

<a href="#fastforward.export.export.process_dynamo_program" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Function for processing a dynamo program.</p>
<p>The function accepts a dynamo program object and a list of operations to be performed on the
graph. It then creates a <code>GraphWrapper</code> object that is responsible for invoking the user-defined
graph operations and logging their output.</p>
<p>In addition, because any graph transformations might alter the names of input parameter nodes
of the dynamo graph a helper function is invoked for mapping the old parameter names (before
transformation) to the new parameter names (after transformation). The function will then
return the parameter mapping result, and any logs collected from the graph operations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dynamo_exported_program</code>
            </td>
            <td>
                  <code><span title="torch.export.exported_program.ExportedProgram">ExportedProgram</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dynamo exported program (representation of a torch module)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>graph_operators</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;code&gt;fastforward.export.export.NodeVisitor&lt;/code&gt;" href="#fastforward.export.export.NodeVisitor">NodeVisitor</a>[<span title="fastforward.export.export._T">_T</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of <code>NodeVisitor</code> objects that are to be invoked for graph
modification/logging</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns:
    new_old_input_spec_mapping: A dictionary mapping the old input spec parameter names to
        the new input spec parameter names (after some operation has taken place in the graph)</p>


            <details class="quote">
              <summary>Source code in <code>fastforward/export/export.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_dynamo_program</span><span class="p">(</span>
    <span class="n">dynamo_exported_program</span><span class="p">:</span> <span class="n">ExportedProgram</span><span class="p">,</span> <span class="n">graph_operators</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">NodeVisitor</span><span class="p">[</span><span class="n">_T</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">ExportedProgram</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function for processing a dynamo program.</span>

<span class="sd">    The function accepts a dynamo program object and a list of operations to be performed on the</span>
<span class="sd">    graph. It then creates a `GraphWrapper` object that is responsible for invoking the user-defined</span>
<span class="sd">    graph operations and logging their output.</span>

<span class="sd">    In addition, because any graph transformations might alter the names of input parameter nodes</span>
<span class="sd">    of the dynamo graph a helper function is invoked for mapping the old parameter names (before</span>
<span class="sd">    transformation) to the new parameter names (after transformation). The function will then</span>
<span class="sd">    return the parameter mapping result, and any logs collected from the graph operations.</span>

<span class="sd">    Args:</span>
<span class="sd">        dynamo_exported_program: A dynamo exported program (representation of a torch module)</span>
<span class="sd">        graph_operators: A list of `NodeVisitor` objects that are to be invoked for graph</span>
<span class="sd">            modification/logging</span>
<span class="sd">    Returns:</span>
<span class="sd">        new_old_input_spec_mapping: A dictionary mapping the old input spec parameter names to</span>
<span class="sd">            the new input spec parameter names (after some operation has taken place in the graph)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">graph_wrapper</span> <span class="o">=</span> <span class="n">GraphWrapper</span><span class="p">(</span><span class="n">dynamo_exported_program</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">operation</span> <span class="ow">in</span> <span class="n">graph_operators</span><span class="p">:</span>
        <span class="n">output_logs</span> <span class="o">=</span> <span class="n">graph_wrapper</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">operation</span><span class="p">)</span>
        <span class="n">logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output_logs</span><span class="p">)</span>

    <span class="n">original_input_specs</span> <span class="o">=</span> <span class="n">dynamo_exported_program</span><span class="o">.</span><span class="n">graph_signature</span><span class="o">.</span><span class="n">input_specs</span>
    <span class="n">dynamo_exported_program</span> <span class="o">=</span> <span class="n">dynamo_exported_program</span><span class="o">.</span><span class="n">run_decompositions</span><span class="p">({})</span>

    <span class="n">updated_input_specs</span> <span class="o">=</span> <span class="n">dynamo_exported_program</span><span class="o">.</span><span class="n">graph_signature</span><span class="o">.</span><span class="n">input_specs</span>
    <span class="n">new_old_input_spec_mapping</span> <span class="o">=</span> <span class="n">get_input_spec_new_old_mapping</span><span class="p">(</span>
        <span class="n">original_input_specs</span><span class="p">,</span> <span class="n">updated_input_specs</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">dynamo_exported_program</span><span class="p">,</span> <span class="n">new_old_input_spec_mapping</span><span class="p">,</span> <span class="n">logs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.annotate", "content.code.copy", "content.tooltips", "navigation.tabs", "toc.follow", "toc.integrate"], "search": "../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>